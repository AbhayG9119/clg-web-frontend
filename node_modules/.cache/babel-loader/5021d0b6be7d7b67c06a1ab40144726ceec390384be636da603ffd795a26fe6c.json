{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Payroll=()=>{const[payrolls,setPayrolls]=useState([]);const[selectedMonth,setSelectedMonth]=useState(new Date().toISOString().slice(0,7));const[loading,setLoading]=useState(false);const[message,setMessage]=useState('');useEffect(()=>{fetchPayrolls();},[selectedMonth]);const fetchPayrolls=async()=>{try{const token=localStorage.getItem('token');const config={headers:{Authorization:\"Bearer \".concat(token)}};const res=await axios.get(\"/api/staff/payroll?month=\".concat(selectedMonth),config);setPayrolls(res.data);}catch(error){console.error('Error fetching payroll:',error);}};const generatePayslip=async()=>{setLoading(true);try{const token=localStorage.getItem('token');const config={headers:{Authorization:\"Bearer \".concat(token)}};await axios.post('/api/staff/payroll/generate',{month:selectedMonth},config);setMessage('Payslip generated successfully');fetchPayrolls();// Refresh\n}catch(error){setMessage('Failed to generate payslip');}setLoading(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"payroll\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Payroll\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"month-selector\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Select Month:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"month\",value:selectedMonth,onChange:e=>setSelectedMonth(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:generatePayslip,disabled:loading,children:\"Generate Payslip\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"message\",children:message}),/*#__PURE__*/_jsx(\"div\",{className:\"payroll-details\",children:payrolls.length>0?payrolls.map(payroll=>/*#__PURE__*/_jsxs(\"div\",{className:\"payslip\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Payslip for \",payroll.month]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Base Salary:\"}),\" \\u20B9\",payroll.baseSalary]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Allowances:\"})}),/*#__PURE__*/_jsx(\"ul\",{children:payroll.allowances.map((allow,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[allow.type,\": \\u20B9\",allow.amount]},idx))}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Deductions:\"})}),/*#__PURE__*/_jsx(\"ul\",{children:payroll.deductions.map((deduct,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[deduct.type,\": \\u20B9\",deduct.amount]},idx))}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Net Salary:\"}),\" \\u20B9\",payroll.netSalary]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",payroll.status]}),payroll.payslipUrl&&/*#__PURE__*/_jsx(\"a\",{href:payroll.payslipUrl,target:\"_blank\",rel:\"noopener noreferrer\",children:\"Download Payslip\"})]},payroll._id)):/*#__PURE__*/_jsx(\"p\",{children:\"No payroll data for selected month.\"})})]});};export default Payroll;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","Payroll","payrolls","setPayrolls","selectedMonth","setSelectedMonth","Date","toISOString","slice","loading","setLoading","message","setMessage","fetchPayrolls","token","localStorage","getItem","config","headers","Authorization","concat","res","get","data","error","console","generatePayslip","post","month","className","children","type","value","onChange","e","target","onClick","disabled","length","map","payroll","baseSalary","allowances","allow","idx","amount","deductions","deduct","netSalary","status","payslipUrl","href","rel","_id"],"sources":["C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/src/components/Staff Pannel/Payroll.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst Payroll = () => {\r\n  const [payrolls, setPayrolls] = useState([]);\r\n  const [selectedMonth, setSelectedMonth] = useState(new Date().toISOString().slice(0, 7));\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchPayrolls();\r\n  }, [selectedMonth]);\r\n\r\n  const fetchPayrolls = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const config = { headers: { Authorization: `Bearer ${token}` } };\r\n      const res = await axios.get(`/api/staff/payroll?month=${selectedMonth}`, config);\r\n      setPayrolls(res.data);\r\n    } catch (error) {\r\n      console.error('Error fetching payroll:', error);\r\n    }\r\n  };\r\n\r\n  const generatePayslip = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const config = { headers: { Authorization: `Bearer ${token}` } };\r\n      await axios.post('/api/staff/payroll/generate', { month: selectedMonth }, config);\r\n      setMessage('Payslip generated successfully');\r\n      fetchPayrolls(); // Refresh\r\n    } catch (error) {\r\n      setMessage('Failed to generate payslip');\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"payroll\">\r\n      <h1>Payroll</h1>\r\n      <div className=\"month-selector\">\r\n        <label>Select Month:</label>\r\n        <input type=\"month\" value={selectedMonth} onChange={(e) => setSelectedMonth(e.target.value)} />\r\n        <button onClick={generatePayslip} disabled={loading}>Generate Payslip</button>\r\n      </div>\r\n      {message && <div className=\"message\">{message}</div>}\r\n      <div className=\"payroll-details\">\r\n        {payrolls.length > 0 ? (\r\n          payrolls.map(payroll => (\r\n            <div key={payroll._id} className=\"payslip\">\r\n              <h3>Payslip for {payroll.month}</h3>\r\n              <p><strong>Base Salary:</strong> ₹{payroll.baseSalary}</p>\r\n              <p><strong>Allowances:</strong></p>\r\n              <ul>\r\n                {payroll.allowances.map((allow, idx) => (\r\n                  <li key={idx}>{allow.type}: ₹{allow.amount}</li>\r\n                ))}\r\n              </ul>\r\n              <p><strong>Deductions:</strong></p>\r\n              <ul>\r\n                {payroll.deductions.map((deduct, idx) => (\r\n                  <li key={idx}>{deduct.type}: ₹{deduct.amount}</li>\r\n                ))}\r\n              </ul>\r\n              <p><strong>Net Salary:</strong> ₹{payroll.netSalary}</p>\r\n              <p><strong>Status:</strong> {payroll.status}</p>\r\n              {payroll.payslipUrl && <a href={payroll.payslipUrl} target=\"_blank\" rel=\"noopener noreferrer\">Download Payslip</a>}\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <p>No payroll data for selected month.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Payroll;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}