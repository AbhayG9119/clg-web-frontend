{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\abhay\\\\Downloads\\\\COL-WEB-ADV-main (4)\\\\clg-web-main1\\\\Frontend\\\\src\\\\components\\\\AdminPanel\\\\CollectFees.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport StudentSearch from './StudentSearch';\nimport FeeSummaryTable from './FeeSummaryTable';\nimport ReceiptViewer from './ReceiptViewer';\nimport Alert from './Alert';\nimport { feesApi } from '../../services/adminApi';\nimport './CollectFees.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CollectFees = () => {\n  _s();\n  const [selectedStudent, setSelectedStudent] = useState(null);\n  const [studentDetails, setStudentDetails] = useState(null);\n  const [fees, setFees] = useState([]);\n  const [feeStructure, setFeeStructure] = useState(null);\n  const [paymentData, setPaymentData] = useState({\n    amount: '',\n    paymentMode: '',\n    remarks: ''\n  });\n  const [receipt, setReceipt] = useState(null);\n  const [showReceipt, setShowReceipt] = useState(false);\n  const [alert, setAlert] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const paymentModes = ['Online', 'Offline'];\n\n  // Ref to keep track of assigned serial numbers for students by ID\n  const studentSerialMap = useRef(new Map());\n  // Ref to keep track of last assigned serial number\n  const lastAssignedSerial = useRef(0);\n  const getSerialNumberForStudent = studentId => {\n    if (studentSerialMap.current.has(studentId)) {\n      return studentSerialMap.current.get(studentId);\n    } else {\n      lastAssignedSerial.current += 1;\n      studentSerialMap.current.set(studentId, lastAssignedSerial.current);\n      return lastAssignedSerial.current;\n    }\n  };\n  const formatStudentId = studentId => {\n    const serialNumber = getSerialNumberForStudent(studentId);\n    // Pad serial number with leading zeros to 4 digits\n    const paddedSerial = serialNumber.toString().padStart(4, '0');\n    return `STU${paddedSerial}`;\n  };\n  useEffect(() => {\n    if (selectedStudent) {\n      fetchStudentDetails();\n      fetchFeeStructure();\n    }\n  }, [selectedStudent]);\n  useEffect(() => {\n    if (selectedStudent && feeStructure) {\n      // Fetch student fees only after fee structure is loaded\n      fetchStudentFees();\n    }\n  }, [selectedStudent, feeStructure]);\n  const fetchStudentDetails = async () => {\n    if (!selectedStudent || !selectedStudent.id) return;\n    setIsLoading(true);\n    const result = await feesApi.getStudentDetails(selectedStudent.id, 'student');\n    setIsLoading(false);\n    if (result.success) {\n      const student = result.data;\n      setStudentDetails({\n        phone: student.mobileNumber || 'N/A',\n        email: student.email || 'N/A',\n        address: `${student.address.street}, ${student.address.city}, ${student.address.state} - ${student.address.pincode}` || 'N/A',\n        dob: student.dateOfBirth ? new Date(student.dateOfBirth).toLocaleDateString() : 'N/A',\n        fatherName: student.guardianName || 'N/A',\n        motherName: 'N/A' // Not available in schema\n      });\n    } else {\n      setAlert({\n        message: 'Failed to fetch student details',\n        type: 'error'\n      });\n    }\n  };\n  const fetchFeeStructure = async () => {\n    if (!selectedStudent || !selectedStudent.class) return;\n    const course = selectedStudent.class.split(' ')[0]; // Extract course from class\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch(`http://localhost:5000/api/fees/${course}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const data = await response.json();\n        setFeeStructure(data);\n      }\n    } catch (error) {\n      console.error('Error fetching fee structure:', error);\n    }\n  };\n  const fetchStudentFees = async () => {\n    if (!selectedStudent || !selectedStudent.id) return;\n    setIsLoading(true);\n    const result = await feesApi.getStudentFees(selectedStudent.id);\n    setIsLoading(false);\n    if (result.success) {\n      // Transform payment data to fee summary format\n      const feeSummary = calculateFeeSummary(result.data);\n      setFees(feeSummary);\n    } else {\n      setAlert({\n        message: 'Failed to fetch student fees',\n        type: 'error'\n      });\n    }\n  };\n  const calculateFeeSummary = payments => {\n    // Use actual fee structure if available, otherwise fallback to defaults\n    let feeHeads = [];\n    if (feeStructure && feeStructure.feeComponents) {\n      // Convert feeComponents object to array format and round to 2 decimal places\n      feeHeads = Object.entries(feeStructure.feeComponents).map(([key, value]) => ({\n        head: key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1'),\n        // Convert camelCase to Title Case\n        total: Math.round((parseFloat(value) || 0) * 100) / 100 // Round to 2 decimals\n      }));\n    } else {\n      // Fallback to default fee heads if fee structure not loaded\n      feeHeads = [{\n        head: 'Tuition Fee',\n        total: 5000\n      }, {\n        head: 'Library Fee',\n        total: 500\n      }, {\n        head: 'Sports Fee',\n        total: 1000\n      }, {\n        head: 'Exam Fee',\n        total: 1500\n      }];\n    }\n\n    // Calculate total paid amount as float, rounded to 2 decimals\n    const totalPaid = Math.round(payments.reduce((sum, payment) => {\n      if (payment.status === 'Paid') {\n        return sum + (parseFloat(payment.amount) || 0);\n      }\n      return sum;\n    }, 0) * 100) / 100;\n\n    // Allocate payments starting from first fee head, then next, etc.\n    let remainingPaid = totalPaid;\n    return feeHeads.map(fee => {\n      const paidForThisFee = Math.min(remainingPaid, fee.total);\n      remainingPaid -= paidForThisFee;\n      return {\n        head: fee.head,\n        amount: fee.total,\n        paid: Math.round(paidForThisFee * 100) / 100,\n        balance: Math.round(Math.max(0, fee.total - paidForThisFee) * 100) / 100\n      };\n    });\n  };\n  const handlePaymentSubmit = async e => {\n    e.preventDefault();\n    const totalDue = fees.reduce((sum, fee) => sum + fee.balance, 0);\n    const amount = parseFloat(paymentData.amount);\n    if (amount <= 0 || amount > totalDue) {\n      setAlert({\n        message: 'Invalid payment amount',\n        type: 'error'\n      });\n      return;\n    }\n    if (!paymentData.paymentMode) {\n      setAlert({\n        message: 'Please select payment mode',\n        type: 'error'\n      });\n      return;\n    }\n    setIsLoading(true);\n    if (!selectedStudent || !selectedStudent.id) {\n      setAlert({\n        message: 'No student selected',\n        type: 'error'\n      });\n      return;\n    }\n    const paymentPayload = {\n      studentId: selectedStudent.id,\n      course: selectedStudent.class.split(' ')[0],\n      // Extract course from class\n      year: parseInt(selectedStudent.class.split(' ')[1]) || 1,\n      // Extract year\n      semester: 1,\n      // Default semester\n      paymentType: 'year',\n      // Default payment type\n      paymentMethod: paymentData.paymentMode.toLowerCase(),\n      remarks: paymentData.remarks || '',\n      amount: amount,\n      status: 'Paid',\n      // Mark as paid immediately\n      paymentDate: new Date().toISOString()\n    };\n    const result = await feesApi.collectFee(paymentPayload);\n    setIsLoading(false);\n    if (result.success) {\n      // Generate receipt\n      const receiptResult = await feesApi.generateReceipt(result.data.paymentId);\n      if (receiptResult.success) {\n        setReceipt({\n          receiptNumber: receiptResult.data.receipt.receiptNumber,\n          date: receiptResult.data.receipt.issuedDate,\n          studentId: selectedStudent.id,\n          studentName: selectedStudent.name,\n          amount: amount,\n          paymentMode: paymentData.paymentMode,\n          remarks: paymentData.remarks || 'No remarks',\n          paymentId: result.data.paymentId,\n          breakdown: fees.filter(fee => fee.balance > 0).map(fee => ({\n            head: fee.head,\n            amount: Math.min(fee.balance, amount)\n          }))\n        });\n        setAlert({\n          message: 'Payment collected successfully! Click \"Generate Receipt\" to view/print the receipt.',\n          type: 'success'\n        });\n      } else {\n        setAlert({\n          message: 'Payment collected but failed to generate receipt',\n          type: 'warning'\n        });\n      }\n      // Reset form\n      setPaymentData({\n        amount: '',\n        paymentMode: '',\n        remarks: ''\n      });\n      // Refresh fees\n      fetchStudentFees();\n    } else {\n      setAlert({\n        message: result.error,\n        type: 'error'\n      });\n    }\n  };\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setPaymentData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const totalDue = fees.reduce((sum, fee) => sum + fee.balance, 0);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"menu-content\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Collect Fees\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 7\n    }, this), alert && /*#__PURE__*/_jsxDEV(Alert, {\n      message: alert.message,\n      type: alert.type,\n      onClose: () => setAlert(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"collect-fees-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"search-section\",\n        children: /*#__PURE__*/_jsxDEV(StudentSearch, {\n          onStudentSelect: setSelectedStudent,\n          placeholder: \"Search student to collect fees...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this), selectedStudent && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"student-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"Student: \", selectedStudent.name, \" (\", formatStudentId(selectedStudent.id), \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Class: \", selectedStudent.class, \" | Session: \", selectedStudent.session]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this), studentDetails && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"additional-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Phone:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 22\n              }, this), \" \", studentDetails.phone || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Email:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 22\n              }, this), \" \", studentDetails.email || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Address:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 22\n              }, this), \" \", studentDetails.address || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Date of Birth:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 22\n              }, this), \" \", studentDetails.dob || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Father's Name:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 22\n              }, this), \" \", studentDetails.fatherName || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Mother's Name:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 22\n              }, this), \" \", studentDetails.motherName || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 13\n        }, this), isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loading\",\n          children: \"Loading fee details...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(FeeSummaryTable, {\n          fees: fees\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"payment-section\",\n          children: !showReceipt ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Payment Entry\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handlePaymentSubmit,\n              className: \"payment-form\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Amount to Pay (\\u20B9):\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  name: \"amount\",\n                  value: paymentData.amount,\n                  onChange: handleInputChange,\n                  min: \"0\",\n                  max: totalDue,\n                  step: \"0.01\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  children: [\"Total due: \\u20B9\", totalDue.toLocaleString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 294,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Payment Mode:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"paymentMode\",\n                  value: paymentData.paymentMode,\n                  onChange: handleInputChange,\n                  required: true,\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Select payment mode\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 305,\n                    columnNumber: 25\n                  }, this), paymentModes.map(mode => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: mode,\n                    children: mode\n                  }, mode, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 307,\n                    columnNumber: 27\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Remarks (Optional):\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 313,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                  name: \"remarks\",\n                  value: paymentData.remarks,\n                  onChange: handleInputChange,\n                  rows: \"3\",\n                  placeholder: \"Enter any remarks...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 314,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 312,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"btn btn-primary\",\n                disabled: isLoading || !paymentData.amount || !paymentData.paymentMode,\n                children: isLoading ? 'Processing...' : 'Collect Fees'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 323,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 19\n            }, this), receipt && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"receipt-preview\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"Receipt Generated Successfully!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"receipt-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Receipt No:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 336,\n                    columnNumber: 28\n                  }, this), \" \", receipt.receiptNumber]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Amount:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 337,\n                    columnNumber: 28\n                  }, this), \" \\u20B9\", receipt.amount.toLocaleString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Payment Mode:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 338,\n                    columnNumber: 28\n                  }, this), \" \", receipt.paymentMode]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 338,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Date:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 339,\n                    columnNumber: 28\n                  }, this), \" \", new Date(receipt.date).toLocaleDateString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 335,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-secondary\",\n                onClick: () => setShowReceipt(true),\n                children: \"Generate Receipt\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(ReceiptViewer, {\n            receipt: receipt,\n            onClose: () => setShowReceipt(false),\n            onPrint: () => setAlert({\n              message: 'Receipt printed successfully!',\n              type: 'success'\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 235,\n    columnNumber: 5\n  }, this);\n};\n_s(CollectFees, \"xVMjOGNxuGr6+Qf8FSwsPBdnq3I=\");\n_c = CollectFees;\nexport default CollectFees;\nvar _c;\n$RefreshReg$(_c, \"CollectFees\");","map":{"version":3,"names":["React","useState","useEffect","useRef","StudentSearch","FeeSummaryTable","ReceiptViewer","Alert","feesApi","jsxDEV","_jsxDEV","Fragment","_Fragment","CollectFees","_s","selectedStudent","setSelectedStudent","studentDetails","setStudentDetails","fees","setFees","feeStructure","setFeeStructure","paymentData","setPaymentData","amount","paymentMode","remarks","receipt","setReceipt","showReceipt","setShowReceipt","alert","setAlert","isLoading","setIsLoading","paymentModes","studentSerialMap","Map","lastAssignedSerial","getSerialNumberForStudent","studentId","current","has","get","set","formatStudentId","serialNumber","paddedSerial","toString","padStart","fetchStudentDetails","fetchFeeStructure","fetchStudentFees","id","result","getStudentDetails","success","student","data","phone","mobileNumber","email","address","street","city","state","pincode","dob","dateOfBirth","Date","toLocaleDateString","fatherName","guardianName","motherName","message","type","class","course","split","token","localStorage","getItem","response","fetch","headers","ok","json","error","console","getStudentFees","feeSummary","calculateFeeSummary","payments","feeHeads","feeComponents","Object","entries","map","key","value","head","charAt","toUpperCase","slice","replace","total","Math","round","parseFloat","totalPaid","reduce","sum","payment","status","remainingPaid","fee","paidForThisFee","min","paid","balance","max","handlePaymentSubmit","e","preventDefault","totalDue","paymentPayload","year","parseInt","semester","paymentType","paymentMethod","toLowerCase","paymentDate","toISOString","collectFee","receiptResult","generateReceipt","paymentId","receiptNumber","date","issuedDate","studentName","name","breakdown","filter","handleInputChange","target","prev","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClose","onStudentSelect","placeholder","session","onSubmit","onChange","step","required","toLocaleString","mode","rows","disabled","onClick","onPrint","_c","$RefreshReg$"],"sources":["C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/src/components/AdminPanel/CollectFees.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport StudentSearch from './StudentSearch';\r\nimport FeeSummaryTable from './FeeSummaryTable';\r\nimport ReceiptViewer from './ReceiptViewer';\r\nimport Alert from './Alert';\r\nimport { feesApi } from '../../services/adminApi';\r\nimport './CollectFees.css';\r\n\r\nconst CollectFees = () => {\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n  const [studentDetails, setStudentDetails] = useState(null);\r\n  const [fees, setFees] = useState([]);\r\n  const [feeStructure, setFeeStructure] = useState(null);\r\n  const [paymentData, setPaymentData] = useState({\r\n    amount: '',\r\n    paymentMode: '',\r\n    remarks: ''\r\n  });\r\n  const [receipt, setReceipt] = useState(null);\r\n  const [showReceipt, setShowReceipt] = useState(false);\r\n  const [alert, setAlert] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const paymentModes = ['Online', 'Offline'];\r\n\r\n  // Ref to keep track of assigned serial numbers for students by ID\r\n  const studentSerialMap = useRef(new Map());\r\n  // Ref to keep track of last assigned serial number\r\n  const lastAssignedSerial = useRef(0);\r\n\r\n  const getSerialNumberForStudent = (studentId) => {\r\n    if (studentSerialMap.current.has(studentId)) {\r\n      return studentSerialMap.current.get(studentId);\r\n    } else {\r\n      lastAssignedSerial.current += 1;\r\n      studentSerialMap.current.set(studentId, lastAssignedSerial.current);\r\n      return lastAssignedSerial.current;\r\n    }\r\n  };\r\n\r\nconst formatStudentId = (studentId) => {\r\n  const serialNumber = getSerialNumberForStudent(studentId);\r\n  // Pad serial number with leading zeros to 4 digits\r\n  const paddedSerial = serialNumber.toString().padStart(4, '0');\r\n  return `STU${paddedSerial}`;\r\n};\r\n\r\n  useEffect(() => {\r\n    if (selectedStudent) {\r\n      fetchStudentDetails();\r\n      fetchFeeStructure();\r\n    }\r\n  }, [selectedStudent]);\r\n\r\n  useEffect(() => {\r\n    if (selectedStudent && feeStructure) {\r\n      // Fetch student fees only after fee structure is loaded\r\n      fetchStudentFees();\r\n    }\r\n  }, [selectedStudent, feeStructure]);\r\n\r\n  const fetchStudentDetails = async () => {\r\n    if (!selectedStudent || !selectedStudent.id) return;\r\n    setIsLoading(true);\r\n    const result = await feesApi.getStudentDetails(selectedStudent.id, 'student');\r\n    setIsLoading(false);\r\n    if (result.success) {\r\n      const student = result.data;\r\n      setStudentDetails({\r\n        phone: student.mobileNumber || 'N/A',\r\n        email: student.email || 'N/A',\r\n        address: `${student.address.street}, ${student.address.city}, ${student.address.state} - ${student.address.pincode}` || 'N/A',\r\n        dob: student.dateOfBirth ? new Date(student.dateOfBirth).toLocaleDateString() : 'N/A',\r\n        fatherName: student.guardianName || 'N/A',\r\n        motherName: 'N/A' // Not available in schema\r\n      });\r\n    } else {\r\n      setAlert({ message: 'Failed to fetch student details', type: 'error' });\r\n    }\r\n  };\r\n\r\n  const fetchFeeStructure = async () => {\r\n    if (!selectedStudent || !selectedStudent.class) return;\r\n    const course = selectedStudent.class.split(' ')[0]; // Extract course from class\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const response = await fetch(`http://localhost:5000/api/fees/${course}`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setFeeStructure(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching fee structure:', error);\r\n    }\r\n  };\r\n\r\n  const fetchStudentFees = async () => {\r\n    if (!selectedStudent || !selectedStudent.id) return;\r\n    setIsLoading(true);\r\n    const result = await feesApi.getStudentFees(selectedStudent.id);\r\n    setIsLoading(false);\r\n    if (result.success) {\r\n      // Transform payment data to fee summary format\r\n      const feeSummary = calculateFeeSummary(result.data);\r\n      setFees(feeSummary);\r\n    } else {\r\n      setAlert({ message: 'Failed to fetch student fees', type: 'error' });\r\n    }\r\n  };\r\n\r\n  const calculateFeeSummary = (payments) => {\r\n    // Use actual fee structure if available, otherwise fallback to defaults\r\n    let feeHeads = [];\r\n\r\n    if (feeStructure && feeStructure.feeComponents) {\r\n      // Convert feeComponents object to array format and round to 2 decimal places\r\n      feeHeads = Object.entries(feeStructure.feeComponents).map(([key, value]) => ({\r\n        head: key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1'), // Convert camelCase to Title Case\r\n        total: Math.round((parseFloat(value) || 0) * 100) / 100 // Round to 2 decimals\r\n      }));\r\n    } else {\r\n      // Fallback to default fee heads if fee structure not loaded\r\n      feeHeads = [\r\n        { head: 'Tuition Fee', total: 5000 },\r\n        { head: 'Library Fee', total: 500 },\r\n        { head: 'Sports Fee', total: 1000 },\r\n        { head: 'Exam Fee', total: 1500 }\r\n      ];\r\n    }\r\n\r\n    // Calculate total paid amount as float, rounded to 2 decimals\r\n    const totalPaid = Math.round(payments.reduce((sum, payment) => {\r\n      if (payment.status === 'Paid') {\r\n        return sum + (parseFloat(payment.amount) || 0);\r\n      }\r\n      return sum;\r\n    }, 0) * 100) / 100;\r\n\r\n    // Allocate payments starting from first fee head, then next, etc.\r\n    let remainingPaid = totalPaid;\r\n    return feeHeads.map(fee => {\r\n      const paidForThisFee = Math.min(remainingPaid, fee.total);\r\n      remainingPaid -= paidForThisFee;\r\n      return {\r\n        head: fee.head,\r\n        amount: fee.total,\r\n        paid: Math.round(paidForThisFee * 100) / 100,\r\n        balance: Math.round(Math.max(0, fee.total - paidForThisFee) * 100) / 100\r\n      };\r\n    });\r\n  };\r\n\r\n  const handlePaymentSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const totalDue = fees.reduce((sum, fee) => sum + fee.balance, 0);\r\n    const amount = parseFloat(paymentData.amount);\r\n\r\n    if (amount <= 0 || amount > totalDue) {\r\n      setAlert({ message: 'Invalid payment amount', type: 'error' });\r\n      return;\r\n    }\r\n\r\n    if (!paymentData.paymentMode) {\r\n      setAlert({ message: 'Please select payment mode', type: 'error' });\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    if (!selectedStudent || !selectedStudent.id) {\r\n      setAlert({ message: 'No student selected', type: 'error' });\r\n      return;\r\n    }\r\n\r\n    const paymentPayload = {\r\n      studentId: selectedStudent.id,\r\n      course: selectedStudent.class.split(' ')[0], // Extract course from class\r\n      year: parseInt(selectedStudent.class.split(' ')[1]) || 1, // Extract year\r\n      semester: 1, // Default semester\r\n      paymentType: 'year', // Default payment type\r\n      paymentMethod: paymentData.paymentMode.toLowerCase(),\r\n      remarks: paymentData.remarks || '',\r\n      amount: amount,\r\n      status: 'Paid', // Mark as paid immediately\r\n      paymentDate: new Date().toISOString()\r\n    };\r\n\r\n    const result = await feesApi.collectFee(paymentPayload);\r\n    setIsLoading(false);\r\n\r\n    if (result.success) {\r\n      // Generate receipt\r\n      const receiptResult = await feesApi.generateReceipt(result.data.paymentId);\r\n      if (receiptResult.success) {\r\n        setReceipt({\r\n          receiptNumber: receiptResult.data.receipt.receiptNumber,\r\n          date: receiptResult.data.receipt.issuedDate,\r\n          studentId: selectedStudent.id,\r\n          studentName: selectedStudent.name,\r\n          amount: amount,\r\n          paymentMode: paymentData.paymentMode,\r\n          remarks: paymentData.remarks || 'No remarks',\r\n          paymentId: result.data.paymentId,\r\n          breakdown: fees.filter(fee => fee.balance > 0).map(fee => ({\r\n            head: fee.head,\r\n            amount: Math.min(fee.balance, amount)\r\n          }))\r\n        });\r\n        setAlert({ message: 'Payment collected successfully! Click \"Generate Receipt\" to view/print the receipt.', type: 'success' });\r\n      } else {\r\n        setAlert({ message: 'Payment collected but failed to generate receipt', type: 'warning' });\r\n      }\r\n      // Reset form\r\n      setPaymentData({ amount: '', paymentMode: '', remarks: '' });\r\n      // Refresh fees\r\n      fetchStudentFees();\r\n    } else {\r\n      setAlert({ message: result.error, type: 'error' });\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setPaymentData(prev => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const totalDue = fees.reduce((sum, fee) => sum + fee.balance, 0);\r\n\r\n  return (\r\n    <div className=\"menu-content\">\r\n      <h1>Collect Fees</h1>\r\n\r\n      {alert && (\r\n        <Alert\r\n          message={alert.message}\r\n          type={alert.type}\r\n          onClose={() => setAlert(null)}\r\n        />\r\n      )}\r\n\r\n      <div className=\"collect-fees-container\">\r\n        <div className=\"search-section\">\r\n          <StudentSearch\r\n            onStudentSelect={setSelectedStudent}\r\n            placeholder=\"Search student to collect fees...\"\r\n          />\r\n        </div>\r\n\r\n        {selectedStudent && (\r\n          <>\r\n            <div className=\"student-info\">\r\n              <h3>Student: {selectedStudent.name} ({formatStudentId(selectedStudent.id)})</h3>\r\n              <p>Class: {selectedStudent.class} | Session: {selectedStudent.session}</p>\r\n              {studentDetails && (\r\n                <div className=\"additional-details\">\r\n                  <p><strong>Phone:</strong> {studentDetails.phone || 'N/A'}</p>\r\n                  <p><strong>Email:</strong> {studentDetails.email || 'N/A'}</p>\r\n                  <p><strong>Address:</strong> {studentDetails.address || 'N/A'}</p>\r\n                  <p><strong>Date of Birth:</strong> {studentDetails.dob || 'N/A'}</p>\r\n                  <p><strong>Father's Name:</strong> {studentDetails.fatherName || 'N/A'}</p>\r\n                  <p><strong>Mother's Name:</strong> {studentDetails.motherName || 'N/A'}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {isLoading ? (\r\n              <div className=\"loading\">Loading fee details...</div>\r\n            ) : (\r\n              <FeeSummaryTable fees={fees} />\r\n            )}\r\n\r\n            <div className=\"payment-section\">\r\n              {!showReceipt ? (\r\n                <>\r\n                  <h3>Payment Entry</h3>\r\n                  <form onSubmit={handlePaymentSubmit} className=\"payment-form\">\r\n                    <div className=\"form-group\">\r\n                      <label>Amount to Pay (₹):</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        name=\"amount\"\r\n                        value={paymentData.amount}\r\n                        onChange={handleInputChange}\r\n                        min=\"0\"\r\n                        max={totalDue}\r\n                        step=\"0.01\"\r\n                        required\r\n                      />\r\n                      <small>Total due: ₹{totalDue.toLocaleString()}</small>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                      <label>Payment Mode:</label>\r\n                      <select\r\n                        name=\"paymentMode\"\r\n                        value={paymentData.paymentMode}\r\n                        onChange={handleInputChange}\r\n                        required\r\n                      >\r\n                        <option value=\"\">Select payment mode</option>\r\n                        {paymentModes.map(mode => (\r\n                          <option key={mode} value={mode}>{mode}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                      <label>Remarks (Optional):</label>\r\n                      <textarea\r\n                        name=\"remarks\"\r\n                        value={paymentData.remarks}\r\n                        onChange={handleInputChange}\r\n                        rows=\"3\"\r\n                        placeholder=\"Enter any remarks...\"\r\n                      />\r\n                    </div>\r\n\r\n                    <button\r\n                      type=\"submit\"\r\n                      className=\"btn btn-primary\"\r\n                      disabled={isLoading || !paymentData.amount || !paymentData.paymentMode}\r\n                    >\r\n                      {isLoading ? 'Processing...' : 'Collect Fees'}\r\n                    </button>\r\n                  </form>\r\n\r\n                  {receipt && (\r\n                    <div className=\"receipt-preview\">\r\n                      <h3>Receipt Generated Successfully!</h3>\r\n                      <div className=\"receipt-info\">\r\n                        <p><strong>Receipt No:</strong> {receipt.receiptNumber}</p>\r\n                        <p><strong>Amount:</strong> ₹{receipt.amount.toLocaleString()}</p>\r\n                        <p><strong>Payment Mode:</strong> {receipt.paymentMode}</p>\r\n                        <p><strong>Date:</strong> {new Date(receipt.date).toLocaleDateString()}</p>\r\n                      </div>\r\n                      <button\r\n                        className=\"btn btn-secondary\"\r\n                        onClick={() => setShowReceipt(true)}\r\n                      >\r\n                        Generate Receipt\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </>\r\n              ) : (\r\n                <ReceiptViewer\r\n                  receipt={receipt}\r\n                  onClose={() => setShowReceipt(false)}\r\n                  onPrint={() => setAlert({ message: 'Receipt printed successfully!', type: 'success' })}\r\n                />\r\n              )}\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CollectFees;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}