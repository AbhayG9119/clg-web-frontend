{"ast":null,"code":"import _objectSpread from\"C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{workApi,staffApi}from'../../services/adminApi';import'./WorkManagement.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AssignWork=()=>{const[tasks,setTasks]=useState([]);const[staff,setStaff]=useState([]);const[formData,setFormData]=useState({task_id:'',staff_id:'',notes:''});const[loading,setLoading]=useState(false);const[message,setMessage]=useState('');const[loadingData,setLoadingData]=useState(true);useEffect(()=>{fetchData();},[]);const fetchData=async()=>{try{const[tasksResult,staffResult]=await Promise.all([workApi.getAllTasks(),staffApi.getStaff()]);if(tasksResult.success){// Filter tasks that are not yet assigned\nconst unassignedTasks=tasksResult.data.filter(task=>task.status==='Open');setTasks(unassignedTasks);}if(staffResult.success){setStaff(staffResult.data);}}catch(error){setMessage('Failed to load data');}finally{setLoadingData(false);}};const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();setLoading(true);setMessage('');try{const result=await workApi.assignTask(formData);if(result.success){setMessage('Task assigned successfully!');setFormData({task_id:'',staff_id:'',notes:''});// Refresh tasks list\nfetchData();}else{setMessage(result.error||'Failed to assign task');}}catch(error){setMessage('An error occurred while assigning the task');}finally{setLoading(false);}};if(loadingData){return/*#__PURE__*/_jsxs(\"div\",{className:\"menu-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Assign Work\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"menu-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Assign Work\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Assign tasks to staff members.\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"alert \".concat(message.includes('success')?'alert-success':'alert-error'),children:message}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"assign-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"task_id\",children:\"Select Task *\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"task_id\",name:\"task_id\",value:formData.task_id,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose a task...\"}),tasks.map(task=>/*#__PURE__*/_jsxs(\"option\",{value:task.task_id,children:[task.title,\" (ID: \",task.task_id,\")\"]},task.task_id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"staff_id\",children:\"Assign To Staff *\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"staff_id\",name:\"staff_id\",value:formData.staff_id,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose staff member...\"}),staff.map(member=>/*#__PURE__*/_jsxs(\"option\",{value:member._id,children:[member.name,\" - \",member.designation]},member._id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"notes\",children:\"Notes (Optional)\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"notes\",name:\"notes\",value:formData.notes,onChange:handleChange,placeholder:\"Add any special instructions...\",rows:\"3\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading||tasks.length===0||staff.length===0,children:loading?'Assigning...':'Assign Task'})]}),tasks.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"info-message\",children:\"No unassigned tasks available. Create new tasks first.\"})]});};export default AssignWork;","map":{"version":3,"names":["React","useState","useEffect","workApi","staffApi","jsx","_jsx","jsxs","_jsxs","AssignWork","tasks","setTasks","staff","setStaff","formData","setFormData","task_id","staff_id","notes","loading","setLoading","message","setMessage","loadingData","setLoadingData","fetchData","tasksResult","staffResult","Promise","all","getAllTasks","getStaff","success","unassignedTasks","data","filter","task","status","error","handleChange","e","_objectSpread","target","name","value","handleSubmit","preventDefault","result","assignTask","className","children","concat","includes","onSubmit","htmlFor","id","onChange","required","map","title","member","_id","designation","placeholder","rows","type","disabled","length"],"sources":["C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/src/components/Admin Pannel/AssignWork.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { workApi, staffApi } from '../../services/adminApi';\r\nimport './WorkManagement.css';\r\n\r\nconst AssignWork = () => {\r\n  const [tasks, setTasks] = useState([]);\r\n  const [staff, setStaff] = useState([]);\r\n  const [formData, setFormData] = useState({\r\n    task_id: '',\r\n    staff_id: '',\r\n    notes: ''\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const [loadingData, setLoadingData] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      const [tasksResult, staffResult] = await Promise.all([\r\n        workApi.getAllTasks(),\r\n        staffApi.getStaff()\r\n      ]);\r\n\r\n      if (tasksResult.success) {\r\n        // Filter tasks that are not yet assigned\r\n        const unassignedTasks = tasksResult.data.filter(task => task.status === 'Open');\r\n        setTasks(unassignedTasks);\r\n      }\r\n\r\n      if (staffResult.success) {\r\n        setStaff(staffResult.data);\r\n      }\r\n    } catch (error) {\r\n      setMessage('Failed to load data');\r\n    } finally {\r\n      setLoadingData(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMessage('');\r\n\r\n    try {\r\n      const result = await workApi.assignTask(formData);\r\n      if (result.success) {\r\n        setMessage('Task assigned successfully!');\r\n        setFormData({\r\n          task_id: '',\r\n          staff_id: '',\r\n          notes: ''\r\n        });\r\n        // Refresh tasks list\r\n        fetchData();\r\n      } else {\r\n        setMessage(result.error || 'Failed to assign task');\r\n      }\r\n    } catch (error) {\r\n      setMessage('An error occurred while assigning the task');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loadingData) {\r\n    return (\r\n      <div className=\"menu-content\">\r\n        <h1>Assign Work</h1>\r\n        <p>Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"menu-content\">\r\n      <h1>Assign Work</h1>\r\n      <p>Assign tasks to staff members.</p>\r\n\r\n      {message && (\r\n        <div className={`alert ${message.includes('success') ? 'alert-success' : 'alert-error'}`}>\r\n          {message}\r\n        </div>\r\n      )}\r\n\r\n      <form onSubmit={handleSubmit} className=\"assign-form\">\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"task_id\">Select Task *</label>\r\n          <select\r\n            id=\"task_id\"\r\n            name=\"task_id\"\r\n            value={formData.task_id}\r\n            onChange={handleChange}\r\n            required\r\n          >\r\n            <option value=\"\">Choose a task...</option>\r\n            {tasks.map(task => (\r\n              <option key={task.task_id} value={task.task_id}>\r\n                {task.title} (ID: {task.task_id})\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"staff_id\">Assign To Staff *</label>\r\n          <select\r\n            id=\"staff_id\"\r\n            name=\"staff_id\"\r\n            value={formData.staff_id}\r\n            onChange={handleChange}\r\n            required\r\n          >\r\n            <option value=\"\">Choose staff member...</option>\r\n            {staff.map(member => (\r\n              <option key={member._id} value={member._id}>\r\n                {member.name} - {member.designation}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"notes\">Notes (Optional)</label>\r\n          <textarea\r\n            id=\"notes\"\r\n            name=\"notes\"\r\n            value={formData.notes}\r\n            onChange={handleChange}\r\n            placeholder=\"Add any special instructions...\"\r\n            rows=\"3\"\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"btn btn-primary\"\r\n          disabled={loading || tasks.length === 0 || staff.length === 0}\r\n        >\r\n          {loading ? 'Assigning...' : 'Assign Task'}\r\n        </button>\r\n      </form>\r\n\r\n      {tasks.length === 0 && (\r\n        <div className=\"info-message\">\r\n          No unassigned tasks available. Create new tasks first.\r\n        </div>\r\n      )}\r\n\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AssignWork;\r\n"],"mappings":"yJAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,OAAO,CAAEC,QAAQ,KAAQ,yBAAyB,CAC3D,MAAO,sBAAsB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE9B,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvB,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACW,KAAK,CAAEC,QAAQ,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACa,QAAQ,CAAEC,WAAW,CAAC,CAAGd,QAAQ,CAAC,CACvCe,OAAO,CAAE,EAAE,CACXC,QAAQ,CAAE,EAAE,CACZC,KAAK,CAAE,EACT,CAAC,CAAC,CACF,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGnB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACoB,OAAO,CAAEC,UAAU,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACsB,WAAW,CAAEC,cAAc,CAAC,CAAGvB,QAAQ,CAAC,IAAI,CAAC,CAEpDC,SAAS,CAAC,IAAM,CACduB,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAACC,WAAW,CAAEC,WAAW,CAAC,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAAC,CACnD1B,OAAO,CAAC2B,WAAW,CAAC,CAAC,CACrB1B,QAAQ,CAAC2B,QAAQ,CAAC,CAAC,CACpB,CAAC,CAEF,GAAIL,WAAW,CAACM,OAAO,CAAE,CACvB;AACA,KAAM,CAAAC,eAAe,CAAGP,WAAW,CAACQ,IAAI,CAACC,MAAM,CAACC,IAAI,EAAIA,IAAI,CAACC,MAAM,GAAK,MAAM,CAAC,CAC/E1B,QAAQ,CAACsB,eAAe,CAAC,CAC3B,CAEA,GAAIN,WAAW,CAACK,OAAO,CAAE,CACvBnB,QAAQ,CAACc,WAAW,CAACO,IAAI,CAAC,CAC5B,CACF,CAAE,MAAOI,KAAK,CAAE,CACdhB,UAAU,CAAC,qBAAqB,CAAC,CACnC,CAAC,OAAS,CACRE,cAAc,CAAC,KAAK,CAAC,CACvB,CACF,CAAC,CAED,KAAM,CAAAe,YAAY,CAAIC,CAAC,EAAK,CAC1BzB,WAAW,CAAA0B,aAAA,CAAAA,aAAA,IACN3B,QAAQ,MACX,CAAC0B,CAAC,CAACE,MAAM,CAACC,IAAI,EAAGH,CAAC,CAACE,MAAM,CAACE,KAAK,EAChC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAO,CAAAL,CAAC,EAAK,CAChCA,CAAC,CAACM,cAAc,CAAC,CAAC,CAClB1B,UAAU,CAAC,IAAI,CAAC,CAChBE,UAAU,CAAC,EAAE,CAAC,CAEd,GAAI,CACF,KAAM,CAAAyB,MAAM,CAAG,KAAM,CAAA5C,OAAO,CAAC6C,UAAU,CAAClC,QAAQ,CAAC,CACjD,GAAIiC,MAAM,CAACf,OAAO,CAAE,CAClBV,UAAU,CAAC,6BAA6B,CAAC,CACzCP,WAAW,CAAC,CACVC,OAAO,CAAE,EAAE,CACXC,QAAQ,CAAE,EAAE,CACZC,KAAK,CAAE,EACT,CAAC,CAAC,CACF;AACAO,SAAS,CAAC,CAAC,CACb,CAAC,IAAM,CACLH,UAAU,CAACyB,MAAM,CAACT,KAAK,EAAI,uBAAuB,CAAC,CACrD,CACF,CAAE,MAAOA,KAAK,CAAE,CACdhB,UAAU,CAAC,4CAA4C,CAAC,CAC1D,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,GAAIG,WAAW,CAAE,CACf,mBACEf,KAAA,QAAKyC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3B5C,IAAA,OAAA4C,QAAA,CAAI,aAAW,CAAI,CAAC,cACpB5C,IAAA,MAAA4C,QAAA,CAAG,YAAU,CAAG,CAAC,EACd,CAAC,CAEV,CAEA,mBACE1C,KAAA,QAAKyC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3B5C,IAAA,OAAA4C,QAAA,CAAI,aAAW,CAAI,CAAC,cACpB5C,IAAA,MAAA4C,QAAA,CAAG,gCAA8B,CAAG,CAAC,CAEpC7B,OAAO,eACNf,IAAA,QAAK2C,SAAS,UAAAE,MAAA,CAAW9B,OAAO,CAAC+B,QAAQ,CAAC,SAAS,CAAC,CAAG,eAAe,CAAG,aAAa,CAAG,CAAAF,QAAA,CACtF7B,OAAO,CACL,CACN,cAEDb,KAAA,SAAM6C,QAAQ,CAAER,YAAa,CAACI,SAAS,CAAC,aAAa,CAAAC,QAAA,eACnD1C,KAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5C,IAAA,UAAOgD,OAAO,CAAC,SAAS,CAAAJ,QAAA,CAAC,eAAa,CAAO,CAAC,cAC9C1C,KAAA,WACE+C,EAAE,CAAC,SAAS,CACZZ,IAAI,CAAC,SAAS,CACdC,KAAK,CAAE9B,QAAQ,CAACE,OAAQ,CACxBwC,QAAQ,CAAEjB,YAAa,CACvBkB,QAAQ,MAAAP,QAAA,eAER5C,IAAA,WAAQsC,KAAK,CAAC,EAAE,CAAAM,QAAA,CAAC,kBAAgB,CAAQ,CAAC,CACzCxC,KAAK,CAACgD,GAAG,CAACtB,IAAI,eACb5B,KAAA,WAA2BoC,KAAK,CAAER,IAAI,CAACpB,OAAQ,CAAAkC,QAAA,EAC5Cd,IAAI,CAACuB,KAAK,CAAC,QAAM,CAACvB,IAAI,CAACpB,OAAO,CAAC,GAClC,GAFaoB,IAAI,CAACpB,OAEV,CACT,CAAC,EACI,CAAC,EACN,CAAC,cAENR,KAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5C,IAAA,UAAOgD,OAAO,CAAC,UAAU,CAAAJ,QAAA,CAAC,mBAAiB,CAAO,CAAC,cACnD1C,KAAA,WACE+C,EAAE,CAAC,UAAU,CACbZ,IAAI,CAAC,UAAU,CACfC,KAAK,CAAE9B,QAAQ,CAACG,QAAS,CACzBuC,QAAQ,CAAEjB,YAAa,CACvBkB,QAAQ,MAAAP,QAAA,eAER5C,IAAA,WAAQsC,KAAK,CAAC,EAAE,CAAAM,QAAA,CAAC,wBAAsB,CAAQ,CAAC,CAC/CtC,KAAK,CAAC8C,GAAG,CAACE,MAAM,eACfpD,KAAA,WAAyBoC,KAAK,CAAEgB,MAAM,CAACC,GAAI,CAAAX,QAAA,EACxCU,MAAM,CAACjB,IAAI,CAAC,KAAG,CAACiB,MAAM,CAACE,WAAW,GADxBF,MAAM,CAACC,GAEZ,CACT,CAAC,EACI,CAAC,EACN,CAAC,cAENrD,KAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5C,IAAA,UAAOgD,OAAO,CAAC,OAAO,CAAAJ,QAAA,CAAC,kBAAgB,CAAO,CAAC,cAC/C5C,IAAA,aACEiD,EAAE,CAAC,OAAO,CACVZ,IAAI,CAAC,OAAO,CACZC,KAAK,CAAE9B,QAAQ,CAACI,KAAM,CACtBsC,QAAQ,CAAEjB,YAAa,CACvBwB,WAAW,CAAC,iCAAiC,CAC7CC,IAAI,CAAC,GAAG,CACT,CAAC,EACC,CAAC,cAEN1D,IAAA,WACE2D,IAAI,CAAC,QAAQ,CACbhB,SAAS,CAAC,iBAAiB,CAC3BiB,QAAQ,CAAE/C,OAAO,EAAIT,KAAK,CAACyD,MAAM,GAAK,CAAC,EAAIvD,KAAK,CAACuD,MAAM,GAAK,CAAE,CAAAjB,QAAA,CAE7D/B,OAAO,CAAG,cAAc,CAAG,aAAa,CACnC,CAAC,EACL,CAAC,CAENT,KAAK,CAACyD,MAAM,GAAK,CAAC,eACjB7D,IAAA,QAAK2C,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAC,wDAE9B,CAAK,CACN,EAGE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAzC,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}