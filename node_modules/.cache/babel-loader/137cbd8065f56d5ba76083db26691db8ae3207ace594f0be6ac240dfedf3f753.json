{"ast":null,"code":"import React,{useState,useEffect}from'react';import'../../styles/ViewDocuments.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ViewDocuments=()=>{const[documents,setDocuments]=useState([]);const[loading,setLoading]=useState(true);const[selectedCourse,setSelectedCourse]=useState('');const courses=['B.A','B.Sc','B.Ed'];useEffect(()=>{fetchDocuments();},[selectedCourse]);const fetchDocuments=async()=>{try{const token=localStorage.getItem('token');const url=selectedCourse?\"/api/users/documents?course=\".concat(encodeURIComponent(selectedCourse)):'/api/users/documents';const response=await fetch(url,{headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){const data=await response.json();setDocuments(data.students);}else{alert('Failed to fetch documents');}}catch(error){console.error('Fetch error:',error);alert('Failed to fetch documents');}finally{setLoading(false);}};const handleDownload=async(studentId,documentType)=>{try{const token=localStorage.getItem('token');const response=await fetch(\"/api/users/documents/download/\".concat(studentId,\"/\").concat(encodeURIComponent(documentType)),{headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=documentType;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);}else{alert('Download failed');}}catch(error){console.error('Download error:',error);alert('Download failed');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading documents...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"view-documents\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"View All Student Documents\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"course-filter\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"course-select\",children:\"Select Course: \"}),/*#__PURE__*/_jsxs(\"select\",{id:\"course-select\",value:selectedCourse,onChange:e=>setSelectedCourse(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Courses\"}),courses.map(course=>/*#__PURE__*/_jsx(\"option\",{value:course,children:course},course))]})]}),documents.map(student=>/*#__PURE__*/_jsxs(\"div\",{className:\"student-documents\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[student.studentName,\" (ID: \",student.studentId,\") - Course: \",student.course]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Document Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:student.documents.map((doc,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:doc.type}),/*#__PURE__*/_jsx(\"td\",{children:doc.status}),/*#__PURE__*/_jsx(\"td\",{children:doc.fileName?/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDownload(student.studentId,doc.type),children:\"Download\"}):/*#__PURE__*/_jsx(\"span\",{children:\"Not Uploaded\"})})]},index))})]})]},student.studentId))]});};export default ViewDocuments;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","ViewDocuments","documents","setDocuments","loading","setLoading","selectedCourse","setSelectedCourse","courses","fetchDocuments","token","localStorage","getItem","url","concat","encodeURIComponent","response","fetch","headers","ok","data","json","students","alert","error","console","handleDownload","studentId","documentType","blob","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","revokeObjectURL","removeChild","children","className","htmlFor","id","value","onChange","e","target","map","course","student","studentName","doc","index","type","status","fileName","onClick"],"sources":["C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/src/components/Admin Pannel/ViewDocuments.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport '../../styles/ViewDocuments.css';\r\n\r\nconst ViewDocuments = () => {\r\n  const [documents, setDocuments] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedCourse, setSelectedCourse] = useState('');\r\n  const courses = ['B.A', 'B.Sc', 'B.Ed'];\r\n\r\n  useEffect(() => {\r\n    fetchDocuments();\r\n  }, [selectedCourse]);\r\n\r\n  const fetchDocuments = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const url = selectedCourse\r\n        ? `/api/users/documents?course=${encodeURIComponent(selectedCourse)}`\r\n        : '/api/users/documents';\r\n\r\n      const response = await fetch(url, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setDocuments(data.students);\r\n      } else {\r\n        alert('Failed to fetch documents');\r\n      }\r\n    } catch (error) {\r\n      console.error('Fetch error:', error);\r\n      alert('Failed to fetch documents');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDownload = async (studentId, documentType) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const response = await fetch(`/api/users/documents/download/${studentId}/${encodeURIComponent(documentType)}`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const blob = await response.blob();\r\n        const url = window.URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = documentType;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        window.URL.revokeObjectURL(url);\r\n        document.body.removeChild(a);\r\n      } else {\r\n        alert('Download failed');\r\n      }\r\n    } catch (error) {\r\n      console.error('Download error:', error);\r\n      alert('Download failed');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>Loading documents...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"view-documents\">\r\n      <h2>View All Student Documents</h2>\r\n      <div className=\"course-filter\">\r\n        <label htmlFor=\"course-select\">Select Course: </label>\r\n        <select\r\n          id=\"course-select\"\r\n          value={selectedCourse}\r\n          onChange={(e) => setSelectedCourse(e.target.value)}\r\n        >\r\n          <option value=\"\">All Courses</option>\r\n          {courses.map(course => (\r\n            <option key={course} value={course}>{course}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      {documents.map(student => (\r\n        <div key={student.studentId} className=\"student-documents\">\r\n          <h3>{student.studentName} (ID: {student.studentId}) - Course: {student.course}</h3>\r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                <th>Document Type</th>\r\n                <th>Status</th>\r\n                <th>Action</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {student.documents.map((doc, index) => (\r\n                <tr key={index}>\r\n                  <td>{doc.type}</td>\r\n                  <td>{doc.status}</td>\r\n                  <td>\r\n                    {doc.fileName ? (\r\n                      <button onClick={() => handleDownload(student.studentId, doc.type)}>Download</button>\r\n                    ) : (\r\n                      <span>Not Uploaded</span>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ViewDocuments;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}