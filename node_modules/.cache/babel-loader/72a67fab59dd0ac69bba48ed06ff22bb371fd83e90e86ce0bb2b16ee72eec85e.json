{"ast":null,"code":"import React,{useState,useRef}from'react';import axios from'axios';import LazyImage from'../../pages/LazyImage';import TutorialButton from'../TutorialButton';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UploadPhoto=()=>{const[selectedFile,setSelectedFile]=useState(null);const[preview,setPreview]=useState(null);const[uploading,setUploading]=useState(false);const[message,setMessage]=useState('');const[error,setError]=useState('');const fileInputRef=useRef(null);const handleFileSelect=event=>{const file=event.target.files[0];if(file){// Validate file type\nconst allowedTypes=['image/jpeg','image/jpg','image/png','image/gif'];if(!allowedTypes.includes(file.type)){setError('Please select a valid image file (JPEG, PNG, GIF)');return;}// Validate file size (5MB limit)\nif(file.size>5*1024*1024){setError('File size must be less than 5MB');return;}setSelectedFile(file);setError('');// Create preview\nconst reader=new FileReader();reader.onload=e=>setPreview(e.target.result);reader.readAsDataURL(file);}};const handleUpload=async()=>{if(!selectedFile){setError('Please select a file first');return;}setUploading(true);setError('');setMessage('');try{const token=localStorage.getItem('token');const formData=new FormData();formData.append('profilePicture',selectedFile);const config={headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'multipart/form-data'}};const response=await axios.post('http://localhost:5000/api/student/profile-picture',formData,config);setMessage('Profile picture uploaded successfully!');setSelectedFile(null);setPreview(null);if(fileInputRef.current){fileInputRef.current.value='';}// Optionally refresh the page or update parent component\nsetTimeout(()=>{window.location.reload();// Simple refresh to show new picture\n},1500);}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Failed to upload profile picture');}finally{setUploading(false);}};const handleCancel=()=>{setSelectedFile(null);setPreview(null);setError('');setMessage('');if(fileInputRef.current){fileInputRef.current.value='';}};return/*#__PURE__*/_jsxs(\"div\",{className:\"upload-photo-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Upload Profile Photo\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Upload and crop profile picture for ID card, attendance logs, and dashboard.\"}),/*#__PURE__*/_jsx(TutorialButton,{videoUrl:\"https://www.youtube.com/watch?v=placeholder-uploadphoto\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",style:{color:'red',marginBottom:'10px'},children:error}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"success-message\",style:{color:'green',marginBottom:'10px'},children:message}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-section\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleFileSelect,accept:\"image/*\",style:{marginBottom:'10px'}}),preview&&/*#__PURE__*/_jsxs(\"div\",{className:\"preview-section\",style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Preview:\"}),/*#__PURE__*/_jsx(LazyImage,{src:preview,alt:\"Profile Preview\",width:200,height:200,style:{borderRadius:'50%',objectFit:'cover',border:'2px solid #ccc'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleUpload,disabled:!selectedFile||uploading,style:{padding:'10px 20px',marginRight:'10px',backgroundColor:selectedFile&&!uploading?'#007bff':'#ccc',color:'white',border:'none',borderRadius:'4px',cursor:selectedFile&&!uploading?'pointer':'not-allowed'},children:uploading?'Uploading...':'Upload Photo'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancel,disabled:uploading,style:{padding:'10px 20px',backgroundColor:'#6c757d',color:'white',border:'none',borderRadius:'4px',cursor:uploading?'not-allowed':'pointer'},children:\"Cancel\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-info\",style:{marginTop:'20px',fontSize:'14px',color:'#666'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Supported formats:\"}),\" JPEG, PNG, GIF\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Maximum file size:\"}),\" 5MB\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Recommended:\"}),\" Square images (1:1 aspect ratio) for best results\"]})]})]});};export default UploadPhoto;","map":{"version":3,"names":["React","useState","useRef","axios","LazyImage","TutorialButton","jsx","_jsx","jsxs","_jsxs","UploadPhoto","selectedFile","setSelectedFile","preview","setPreview","uploading","setUploading","message","setMessage","error","setError","fileInputRef","handleFileSelect","event","file","target","files","allowedTypes","includes","type","size","reader","FileReader","onload","e","result","readAsDataURL","handleUpload","token","localStorage","getItem","formData","FormData","append","config","headers","Authorization","concat","response","post","current","value","setTimeout","window","location","reload","_error$response","_error$response$data","data","handleCancel","className","children","videoUrl","style","color","marginBottom","ref","onChange","accept","src","alt","width","height","borderRadius","objectFit","border","onClick","disabled","padding","marginRight","backgroundColor","cursor","marginTop","fontSize"],"sources":["C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/src/components/Student Pannel/UploadPhoto.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport LazyImage from '../../pages/LazyImage';\r\nimport TutorialButton from '../TutorialButton';\r\n\r\nconst UploadPhoto = () => {\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [preview, setPreview] = useState(null);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const [error, setError] = useState('');\r\n  const fileInputRef = useRef(null);\r\n\r\n  const handleFileSelect = (event) => {\r\n    const file = event.target.files[0];\r\n    if (file) {\r\n      // Validate file type\r\n      const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];\r\n      if (!allowedTypes.includes(file.type)) {\r\n        setError('Please select a valid image file (JPEG, PNG, GIF)');\r\n        return;\r\n      }\r\n\r\n      // Validate file size (5MB limit)\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        setError('File size must be less than 5MB');\r\n        return;\r\n      }\r\n\r\n      setSelectedFile(file);\r\n      setError('');\r\n\r\n      // Create preview\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => setPreview(e.target.result);\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const handleUpload = async () => {\r\n    if (!selectedFile) {\r\n      setError('Please select a file first');\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    setError('');\r\n    setMessage('');\r\n\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const formData = new FormData();\r\n      formData.append('profilePicture', selectedFile);\r\n\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'multipart/form-data'\r\n        }\r\n      };\r\n\r\n      const response = await axios.post('http://localhost:5000/api/student/profile-picture', formData, config);\r\n\r\n      setMessage('Profile picture uploaded successfully!');\r\n      setSelectedFile(null);\r\n      setPreview(null);\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n\r\n      // Optionally refresh the page or update parent component\r\n      setTimeout(() => {\r\n        window.location.reload(); // Simple refresh to show new picture\r\n      }, 1500);\r\n\r\n    } catch (error) {\r\n      setError(error.response?.data?.message || 'Failed to upload profile picture');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setSelectedFile(null);\r\n    setPreview(null);\r\n    setError('');\r\n    setMessage('');\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"upload-photo-container\">\r\n      <h1>Upload Profile Photo</h1>\r\n      <p>Upload and crop profile picture for ID card, attendance logs, and dashboard.</p>\r\n      <TutorialButton videoUrl=\"https://www.youtube.com/watch?v=placeholder-uploadphoto\" />\r\n\r\n      {error && <div className=\"error-message\" style={{ color: 'red', marginBottom: '10px' }}>{error}</div>}\r\n      {message && <div className=\"success-message\" style={{ color: 'green', marginBottom: '10px' }}>{message}</div>}\r\n\r\n      <div className=\"upload-section\">\r\n        <input\r\n          type=\"file\"\r\n          ref={fileInputRef}\r\n          onChange={handleFileSelect}\r\n          accept=\"image/*\"\r\n          style={{ marginBottom: '10px' }}\r\n        />\r\n\r\n        {preview && (\r\n          <div className=\"preview-section\" style={{ marginBottom: '20px' }}>\r\n            <h3>Preview:</h3>\r\n            <LazyImage\r\n              src={preview}\r\n              alt=\"Profile Preview\"\r\n              width={200}\r\n              height={200}\r\n              style={{\r\n                borderRadius: '50%',\r\n                objectFit: 'cover',\r\n                border: '2px solid #ccc'\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"upload-actions\">\r\n          <button\r\n            onClick={handleUpload}\r\n            disabled={!selectedFile || uploading}\r\n            style={{\r\n              padding: '10px 20px',\r\n              marginRight: '10px',\r\n              backgroundColor: selectedFile && !uploading ? '#007bff' : '#ccc',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '4px',\r\n              cursor: selectedFile && !uploading ? 'pointer' : 'not-allowed'\r\n            }}\r\n          >\r\n            {uploading ? 'Uploading...' : 'Upload Photo'}\r\n          </button>\r\n\r\n          <button\r\n            onClick={handleCancel}\r\n            disabled={uploading}\r\n            style={{\r\n              padding: '10px 20px',\r\n              backgroundColor: '#6c757d',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '4px',\r\n              cursor: uploading ? 'not-allowed' : 'pointer'\r\n            }}\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"upload-info\" style={{ marginTop: '20px', fontSize: '14px', color: '#666' }}>\r\n        <p><strong>Supported formats:</strong> JPEG, PNG, GIF</p>\r\n        <p><strong>Maximum file size:</strong> 5MB</p>\r\n        <p><strong>Recommended:</strong> Square images (1:1 aspect ratio) for best results</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UploadPhoto;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}