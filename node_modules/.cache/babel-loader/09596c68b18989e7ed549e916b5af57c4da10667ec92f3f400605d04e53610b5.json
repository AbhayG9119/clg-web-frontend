{"ast":null,"code":"import _objectSpread from\"C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{workApi}from'../../services/adminApi';import'./WorkManagement.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AddWorkReport=()=>{const[assignments,setAssignments]=useState([]);const[formData,setFormData]=useState({task_id:'',content:'',attachments:[]});const[loading,setLoading]=useState(false);const[message,setMessage]=useState('');const[loadingData,setLoadingData]=useState(true);useEffect(()=>{fetchAssignments();},[]);const fetchAssignments=async()=>{try{const result=await workApi.getTaskStatus();if(result.success){// Filter assignments that belong to current user (staff)\n// In a real app, this would be handled by backend role-based filtering\nsetAssignments(result.data);}}catch(error){setMessage('Failed to load assigned tasks');}finally{setLoadingData(false);}};const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};const handleFileChange=e=>{const files=Array.from(e.target.files);setFormData(_objectSpread(_objectSpread({},formData),{},{attachments:files}));};const handleSubmit=async e=>{e.preventDefault();setLoading(true);setMessage('');try{// For now, we'll submit without file uploads\n// File upload functionality would need backend support\nconst submitData={task_id:parseInt(formData.task_id),content:formData.content,attachments:[]// Placeholder for file URLs\n};const result=await workApi.submitReport(submitData);if(result.success){setMessage('Report submitted successfully!');setFormData({task_id:'',content:'',attachments:[]});}else{setMessage(result.error||'Failed to submit report');}}catch(error){setMessage('An error occurred while submitting the report');}finally{setLoading(false);}};if(loadingData){return/*#__PURE__*/_jsxs(\"div\",{className:\"menu-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Add Work Report\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"menu-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Add Work Report\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Submit progress reports for your assigned tasks.\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"alert \".concat(message.includes('success')?'alert-success':'alert-error'),children:message}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"report-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"task_id\",children:\"Select Task *\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"task_id\",name:\"task_id\",value:formData.task_id,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose a task...\"}),assignments.map(assignment=>/*#__PURE__*/_jsxs(\"option\",{value:assignment.task_id,children:[assignment.task_id.title,\" (ID: \",assignment.task_id.task_id,\")\"]},assignment.task_id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"content\",children:\"Report Content *\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"content\",name:\"content\",value:formData.content,onChange:handleChange,required:true,placeholder:\"Describe your progress, challenges faced, and next steps...\",rows:\"6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"attachments\",children:\"Attachments (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"attachments\",name:\"attachments\",onChange:handleFileChange,multiple:true,accept:\".pdf,.doc,.docx,.jpg,.jpeg,.png\"}),/*#__PURE__*/_jsx(\"small\",{className:\"help-text\",children:\"Supported formats: PDF, DOC, DOCX, JPG, PNG\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading||assignments.length===0,children:loading?'Submitting...':'Submit Report'})]}),assignments.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"info-message\",children:\"No assigned tasks available. Please contact your administrator.\"})]});};export default AddWorkReport;","map":{"version":3,"names":["React","useState","useEffect","workApi","jsx","_jsx","jsxs","_jsxs","AddWorkReport","assignments","setAssignments","formData","setFormData","task_id","content","attachments","loading","setLoading","message","setMessage","loadingData","setLoadingData","fetchAssignments","result","getTaskStatus","success","data","error","handleChange","e","_objectSpread","target","name","value","handleFileChange","files","Array","from","handleSubmit","preventDefault","submitData","parseInt","submitReport","className","children","concat","includes","onSubmit","htmlFor","id","onChange","required","map","assignment","title","placeholder","rows","type","multiple","accept","disabled","length"],"sources":["C:/Users/abhay/Downloads/COL-WEB-ADV-main (4)/clg-web-main1/Frontend/src/components/Admin Pannel/AddWorkReport.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { workApi } from '../../services/adminApi';\r\nimport './WorkManagement.css';\r\n\r\nconst AddWorkReport = () => {\r\n  const [assignments, setAssignments] = useState([]);\r\n  const [formData, setFormData] = useState({\r\n    task_id: '',\r\n    content: '',\r\n    attachments: []\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const [loadingData, setLoadingData] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchAssignments();\r\n  }, []);\r\n\r\n  const fetchAssignments = async () => {\r\n    try {\r\n      const result = await workApi.getTaskStatus();\r\n      if (result.success) {\r\n        // Filter assignments that belong to current user (staff)\r\n        // In a real app, this would be handled by backend role-based filtering\r\n        setAssignments(result.data);\r\n      }\r\n    } catch (error) {\r\n      setMessage('Failed to load assigned tasks');\r\n    } finally {\r\n      setLoadingData(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  const handleFileChange = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    setFormData({\r\n      ...formData,\r\n      attachments: files\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMessage('');\r\n\r\n    try {\r\n      // For now, we'll submit without file uploads\r\n      // File upload functionality would need backend support\r\n      const submitData = {\r\n        task_id: parseInt(formData.task_id),\r\n        content: formData.content,\r\n        attachments: [] // Placeholder for file URLs\r\n      };\r\n\r\n      const result = await workApi.submitReport(submitData);\r\n      if (result.success) {\r\n        setMessage('Report submitted successfully!');\r\n        setFormData({\r\n          task_id: '',\r\n          content: '',\r\n          attachments: []\r\n        });\r\n      } else {\r\n        setMessage(result.error || 'Failed to submit report');\r\n      }\r\n    } catch (error) {\r\n      setMessage('An error occurred while submitting the report');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loadingData) {\r\n    return (\r\n      <div className=\"menu-content\">\r\n        <h1>Add Work Report</h1>\r\n        <p>Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"menu-content\">\r\n      <h1>Add Work Report</h1>\r\n      <p>Submit progress reports for your assigned tasks.</p>\r\n\r\n      {message && (\r\n        <div className={`alert ${message.includes('success') ? 'alert-success' : 'alert-error'}`}>\r\n          {message}\r\n        </div>\r\n      )}\r\n\r\n      <form onSubmit={handleSubmit} className=\"report-form\">\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"task_id\">Select Task *</label>\r\n          <select\r\n            id=\"task_id\"\r\n            name=\"task_id\"\r\n            value={formData.task_id}\r\n            onChange={handleChange}\r\n            required\r\n          >\r\n            <option value=\"\">Choose a task...</option>\r\n            {assignments.map(assignment => (\r\n              <option key={assignment.task_id} value={assignment.task_id}>\r\n                {assignment.task_id.title} (ID: {assignment.task_id.task_id})\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"content\">Report Content *</label>\r\n          <textarea\r\n            id=\"content\"\r\n            name=\"content\"\r\n            value={formData.content}\r\n            onChange={handleChange}\r\n            required\r\n            placeholder=\"Describe your progress, challenges faced, and next steps...\"\r\n            rows=\"6\"\r\n          />\r\n        </div>\r\n\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"attachments\">Attachments (Optional)</label>\r\n          <input\r\n            type=\"file\"\r\n            id=\"attachments\"\r\n            name=\"attachments\"\r\n            onChange={handleFileChange}\r\n            multiple\r\n            accept=\".pdf,.doc,.docx,.jpg,.jpeg,.png\"\r\n          />\r\n          <small className=\"help-text\">\r\n            Supported formats: PDF, DOC, DOCX, JPG, PNG\r\n          </small>\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"btn btn-primary\"\r\n          disabled={loading || assignments.length === 0}\r\n        >\r\n          {loading ? 'Submitting...' : 'Submit Report'}\r\n        </button>\r\n      </form>\r\n\r\n      {assignments.length === 0 && (\r\n        <div className=\"info-message\">\r\n          No assigned tasks available. Please contact your administrator.\r\n        </div>\r\n      )}\r\n\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AddWorkReport;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}